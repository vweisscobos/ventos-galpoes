<html>
<head>
<title>coeficientesDePressao.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #000080; font-weight: bold;}
.s1 { color: #000000;}
.s2 { color: #008000; font-weight: bold;}
.s3 { color: #808080; font-style: italic;}
.s4 { color: #0000ff;}
.ln { color: #999999; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
coeficientesDePressao.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">const </span>Utils = require(<span class="s2">&quot;./utils&quot;</span>);

<span class="s3">// PI - Pressão Interna</span>
// PE - Pressão Externa
// AD - Abertura Dominante
// AR - Altura Relativa

<span class="s0">const </span>TABELA_4 = [
  [
    {
      ventoAZero: {
        a1: -<span class="s4">0.8</span>,
        b1: -<span class="s4">0.8</span>,
        a2: -<span class="s4">0.5</span>,
        b2: -<span class="s4">0.5</span>,
        c: <span class="s4">0.7</span>,
        d: -<span class="s4">0.4</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.7</span>,
        b: -<span class="s4">0.4</span>,
        c1: -<span class="s4">0.8</span>,
        d1: -<span class="s4">0.8</span>,
        c2: -<span class="s4">0.4</span>,
        d2: -<span class="s4">0.4</span>
      }
    },
    {
      ventoAZero: {
        a1: -<span class="s4">0.8</span>,
        b1: -<span class="s4">0.8</span>,
        a2: -<span class="s4">0.4</span>,
        b2: -<span class="s4">0.4</span>,
        c: <span class="s4">0.7</span>,
        d: -<span class="s4">0.3</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.7</span>,
        b: -<span class="s4">0.5</span>,
        c1: -<span class="s4">0.9</span>,
        d1: -<span class="s4">0.9</span>,
        c2: -<span class="s4">0.5</span>,
        d2: -<span class="s4">0.5</span>
      }
    }
  ],
  [
    {
      ventoAZero: {
        a1: -<span class="s4">0.9</span>,
        b1: -<span class="s4">0.9</span>,
        a2: -<span class="s4">0.5</span>,
        b2: -<span class="s4">0.5</span>,
        c: <span class="s4">0.7</span>,
        d: -<span class="s4">0.5</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.7</span>,
        b: -<span class="s4">0.5</span>,
        c1: -<span class="s4">0.9</span>,
        d1: -<span class="s4">0.9</span>,
        c2: -<span class="s4">0.5</span>,
        d2: -<span class="s4">0.5</span>
      }
    },
    {
      ventoAZero: {
        a1: -<span class="s4">0.9</span>,
        b1: -<span class="s4">0.9</span>,
        a2: -<span class="s4">0.4</span>,
        b2: -<span class="s4">0.4</span>,
        c: <span class="s4">0.7</span>,
        d: -<span class="s4">0.3</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.7</span>,
        b: -<span class="s4">0.6</span>,
        c1: -<span class="s4">0.9</span>,
        d1: -<span class="s4">0.9</span>,
        c2: -<span class="s4">0.5</span>,
        d2: -<span class="s4">0.5</span>
      }
    }
  ],
  [
    {
      ventoAZero: {
        a1: -<span class="s4">1.0</span>,
        b1: -<span class="s4">1.0</span>,
        a2: -<span class="s4">0.6</span>,
        b2: -<span class="s4">0.6</span>,
        c: <span class="s4">0.8</span>,
        d: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.8</span>,
        b: -<span class="s4">0.6</span>,
        c1: -<span class="s4">1.0</span>,
        d1: -<span class="s4">1.0</span>,
        c2: -<span class="s4">0.6</span>,
        d2: -<span class="s4">0.6</span>
      }
    },
    {
      ventoAZero: {
        a1: -<span class="s4">1.0</span>,
        b1: -<span class="s4">1.0</span>,
        a2: -<span class="s4">0.5</span>,
        b2: -<span class="s4">0.5</span>,
        c: <span class="s4">0.8</span>,
        d: -<span class="s4">0.3</span>
      },
      ventoANoventa: {
        a: <span class="s4">0.8</span>,
        b: -<span class="s4">0.6</span>,
        c1: -<span class="s4">1.0</span>,
        d1: -<span class="s4">1.0</span>,
        c2: -<span class="s4">0.6</span>,
        d2: -<span class="s4">0.6</span>
      }
    }
  ]
];

<span class="s3">// Tabela 5 - coeficientes de pressão e de forma, externos, para telhados com duas águas, simétricos,</span>
//  em edificações de planta retangular
<span class="s0">const </span>TABELA_5 = [
  [
    {
      <span class="s3">//  Θ = 5°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.4</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">//  Θ = 5°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.4</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.9</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">//  Θ = 10°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">1.2</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">// Θ = 15°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">1.0</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">// Θ = 20°</span>
      ventoAZero: {
        frente: -<span class="s4">0.7</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.4</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">// Θ = 30°</span>
      ventoAZero: {
        frente: -<span class="s4">0.7</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0</span>,
        direita: -<span class="s4">0.4</span>
      }
    },
    {
      <span class="s3">//  Θ = 45°</span>
      ventoAZero: {
        frente: -<span class="s4">0.7</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.3</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">//  Θ = 60°</span>
      ventoAZero: {
        frente: -<span class="s4">0.7</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.7</span>,
        direita: -<span class="s4">0.6</span>
      }
    }
  ],
  [
    {
      <span class="s3">//  Θ = 0°</span>
      ventoAZero: {
        frente: -<span class="s4">1.0</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">//  Θ = 5°</span>
      ventoAZero: {
        frente: -<span class="s4">0.9</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.9</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">//  Θ = 10°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">1.1</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">// Θ = 15°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">1.0</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">// Θ = 20°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.6</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.7</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">// Θ = 30°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.2</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">// Θ = 45°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.2</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">//  Θ = 60°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.6</span>,
        direita: -<span class="s4">0.5</span>
      }
    }
  ],
  [
    {
      <span class="s3">//  Θ = 0°</span>
      ventoAZero: {
        frente: -<span class="s4">0.9</span>,
        tras: -<span class="s4">0.7</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">//  Θ = 5°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">//  Θ = 10°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">// Θ = 15°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">// Θ = 20°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.8</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.8</span>,
        direita: -<span class="s4">0.6</span>
      }
    },
    {
      <span class="s3">// Θ = 30°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.7</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">1.0</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">// Θ = 40°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.7</span>
      },
      ventoANoventa: {
        esquerda: -<span class="s4">0.2</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">// Θ = 50°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.7</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.2</span>,
        direita: -<span class="s4">0.5</span>
      }
    },
    {
      <span class="s3">//  Θ = 60°</span>
      ventoAZero: {
        frente: -<span class="s4">0.8</span>,
        tras: -<span class="s4">0.7</span>
      },
      ventoANoventa: {
        esquerda: <span class="s4">0.2</span>,
        direita: -<span class="s4">0.5</span>
      }
    }
  ]
];

<span class="s0">const </span>PI_AD_BARLAVENTO = <span class="s0">new </span>Map(
  [
    [<span class="s4">1</span>, <span class="s4">0.1</span>],
    [<span class="s4">1.5</span>, <span class="s4">0.3</span>],
    [<span class="s4">2</span>, <span class="s4">0.5</span>],
    [<span class="s4">3</span>, <span class="s4">0.6</span>],
    [<span class="s4">6</span>, <span class="s4">0.8</span>]
  ]
);

<span class="s0">const </span>PI_AD_ALTA_SUCCAO = <span class="s0">new </span>Map([
  [<span class="s4">0.25</span>, -<span class="s4">0.4</span>],
  [<span class="s4">0.5</span>, -<span class="s4">0.5</span>],
  [<span class="s4">0.75</span>, -<span class="s4">0.6</span>],
  [<span class="s4">1</span>, -<span class="s4">0.7</span>],
  [<span class="s4">1.5</span>, -<span class="s4">0.8</span>],
  [<span class="s4">3</span>, -<span class="s4">0.9</span>]
]);

<span class="s0">const </span>MAPA_ANG_AR_FAIXAS_UM_DOIS = <span class="s0">new </span>Map(
  [
    [<span class="s4">0</span>, <span class="s4">0</span>],
    [<span class="s4">5</span>, <span class="s4">1</span>],
    [<span class="s4">10</span>, <span class="s4">2</span>],
    [<span class="s4">15</span>, <span class="s4">3</span>],
    [<span class="s4">20</span>, <span class="s4">4</span>],
    [<span class="s4">30</span>, <span class="s4">5</span>],
    [<span class="s4">45</span>, <span class="s4">6</span>],
    [<span class="s4">60</span>, <span class="s4">7</span>]
  ]
);

<span class="s0">const </span>MAPA_ANG_AR_FAIXA_TRES = <span class="s0">new </span>Map(
  [
    [<span class="s4">0</span>, <span class="s4">0</span>],
    [<span class="s4">5</span>, <span class="s4">1</span>],
    [<span class="s4">10</span>, <span class="s4">2</span>],
    [<span class="s4">15</span>, <span class="s4">3</span>],
    [<span class="s4">20</span>, <span class="s4">4</span>],
    [<span class="s4">30</span>, <span class="s4">5</span>],
    [<span class="s4">40</span>, <span class="s4">6</span>],
    [<span class="s4">50</span>, <span class="s4">7</span>],
    [<span class="s4">60</span>, <span class="s4">8</span>]
  ]
);

<span class="s0">const </span>externaParedesPlantaRetangular = ({comprimento, largura, altura}) =&gt; {
  <span class="s0">let </span>alturaRelativa,
    proporcaoEntreDimensoesHorizontais,
    indiceAlturaRelativa,
    coeficientesPressaoExterna;

  <span class="s0">if </span>(comprimento &lt; largura) {
    <span class="s0">let </span>helper = largura;
    largura = comprimento;
    comprimento = helper;
  }

  alturaRelativa = altura/largura;
  proporcaoEntreDimensoesHorizontais = comprimento/largura;

  <span class="s0">if </span>(alturaRelativa &lt;= <span class="s4">1</span>/<span class="s4">2</span>) {
    indiceAlturaRelativa = <span class="s4">0</span>;
  } <span class="s0">else if </span>(alturaRelativa &lt;= <span class="s4">3</span>/<span class="s4">2</span>) {
    indiceAlturaRelativa = <span class="s4">1</span>;
  } <span class="s0">else if </span>(alturaRelativa &lt;= <span class="s4">6</span>) {
    indiceAlturaRelativa = <span class="s4">2</span>;
  }

  <span class="s0">if </span>(proporcaoEntreDimensoesHorizontais &gt;= <span class="s4">1 </span>&amp;&amp; proporcaoEntreDimensoesHorizontais &lt;= <span class="s4">3</span>/<span class="s4">2</span>) {
    coeficientesPressaoExterna = TABELA_4[indiceAlturaRelativa][<span class="s4">0</span>];
  }  <span class="s0">else if </span>(proporcaoEntreDimensoesHorizontais &gt;= <span class="s4">2 </span>&amp;&amp; proporcaoEntreDimensoesHorizontais &lt;= <span class="s4">4</span>) {
    coeficientesPressaoExterna = TABELA_4[indiceAlturaRelativa][<span class="s4">1</span>];
  } <span class="s0">else if </span>(proporcaoEntreDimensoesHorizontais &gt; <span class="s4">3</span>/<span class="s4">2 </span>&amp;&amp; proporcaoEntreDimensoesHorizontais &lt; <span class="s4">2</span>) {
    coeficientesPressaoExterna = interpolarCoeficientesDePressaoExterna(indiceAlturaRelativa, proporcaoEntreDimensoesHorizontais);
  } <span class="s0">else </span>{
    <span class="s0">throw new </span>Error(<span class="s2">'Valor inválido: faixa de valores inválidos'</span>)
  }

  coeficientesPressaoExterna.ventoAZero[<span class="s2">'a3'</span>] = calcularA3eB3(
    proporcaoEntreDimensoesHorizontais, coeficientesPressaoExterna.ventoAZero[<span class="s2">'a2'</span>]);
  coeficientesPressaoExterna.ventoAZero[<span class="s2">'b3'</span>] = calcularA3eB3(
    proporcaoEntreDimensoesHorizontais, coeficientesPressaoExterna.ventoAZero[<span class="s2">'b2'</span>]);

  <span class="s0">return </span>coeficientesPressaoExterna;
};

<span class="s0">const </span>calcularA3eB3 = (proporcaoDimensoeshorizontais, coefDeReferencia) =&gt; {
  <span class="s0">if </span>(proporcaoDimensoeshorizontais === <span class="s4">1</span>) <span class="s0">return </span>coefDeReferencia;
  <span class="s0">else if </span>(proporcaoDimensoeshorizontais &gt;= <span class="s4">2</span>) <span class="s0">return </span>-<span class="s4">0.2</span>;
  <span class="s0">else </span>{
    <span class="s0">return </span>Utils.interpolar(<span class="s4">1</span>, coefDeReferencia, <span class="s4">2</span>, -<span class="s4">0.2</span>, proporcaoDimensoeshorizontais);
  }
};

<span class="s0">const </span>interpolarCoeficientesDePressaoExterna = (indiceAlturaRelativa, proporcao) =&gt; {
  <span class="s0">let </span>coeficientes = { ventoAZero: {}, ventoANoventa: {} };
  <span class="s0">let </span>valoresParaProporcaoTresMeios = TABELA_4[indiceAlturaRelativa][<span class="s4">0</span>];
  <span class="s0">let </span>valoresParaProporcaoDois = TABELA_4[indiceAlturaRelativa][<span class="s4">1</span>];

  coeficientes.ventoAZero = interpolarObjetos(
    <span class="s4">1.5</span>,
    valoresParaProporcaoTresMeios.ventoAZero,
    <span class="s4">2</span>,
    valoresParaProporcaoDois.ventoAZero,
    proporcao
  );

  coeficientes.ventoANoventa = interpolarObjetos(
    <span class="s4">1.5</span>,
    valoresParaProporcaoTresMeios.ventoANoventa,
    <span class="s4">2</span>,
    valoresParaProporcaoDois.ventoANoventa,
    proporcao
  );

  <span class="s0">return </span>coeficientes;
};

<span class="s0">const </span>interna = (
  { tipo, faces, aberturas },
  coefsPressaoExterna
) =&gt; {
  <span class="s0">if </span>(tipo === <span class="s2">&quot;faces opostas&quot;</span>) {
    <span class="s0">switch </span>(faces) {
      <span class="s0">case </span><span class="s2">&quot;frente-tras&quot;</span>:
        <span class="s0">return </span>{
          ventoAZero: <span class="s4">0.2</span>,
          ventoANoventa: -<span class="s4">0.3</span>
        };
      <span class="s0">case </span><span class="s2">&quot;laterais&quot;</span>:
        <span class="s0">return </span>{
          ventoANoventa: <span class="s4">0.2</span>,
          ventoAZero: -<span class="s4">0.3</span>
        };
      <span class="s0">default</span>:
        <span class="s0">throw new </span>Error(<span class="s2">&quot;O valor de entrada para faces permeáveis não é válido: &quot; </span>+ faces);
    }
  } <span class="s0">else if </span>(tipo === <span class="s2">&quot;quatro faces&quot;</span>) {
    <span class="s0">return </span>[<span class="s4">0</span>, -<span class="s4">0.3</span>]
  } <span class="s0">else if </span>(tipo === <span class="s2">&quot;abertura dominante&quot;</span>) {
    <span class="s0">return </span>calcularIndicePressaoInternaAberturaDominante(
      aberturas,
      coefsPressaoExterna
    )
  } <span class="s0">else </span>{
    <span class="s0">throw new </span>Error(<span class="s2">&quot;O valor de entrada para tipo de permeabilidade não é válido :&quot; </span>+ tipo);
  }
};

<span class="s0">const </span>calcularIndicePressaoInternaAberturaDominante = (
  aberturas,
  coefsPressaoExterna
) =&gt; {
  <span class="s0">let </span>coeficientes = { ventoAZero: <span class="s4">0</span>, ventoANoventa: <span class="s4">0 </span>},
      secaoDominante;

  <span class="s0">for </span>(<span class="s0">let </span>secao <span class="s0">in </span>aberturas) {
    aberturas[secao] = parseInt(aberturas[secao]);
  }

  <span class="s0">for </span>(<span class="s0">let </span>secao <span class="s0">in </span>aberturas) {
    <span class="s0">if </span>(!secaoDominante) secaoDominante = secao;

    <span class="s0">if </span>(aberturas[secao] &gt; aberturas[secaoDominante]) secaoDominante = secao;
  }

  coeficientes.ventoAZero = IndicePressaoInternaAberturaDominanteVentoAZero(
    secaoDominante, aberturas, coefsPressaoExterna.ventoAZero);
  coeficientes.ventoANoventa = IndicePressaoInternaAberturaDominanteVentoANoventa(
    secaoDominante, aberturas, coefsPressaoExterna.ventoANoventa);

  <span class="s0">return </span>coeficientes;
};

<span class="s0">const </span>somarAreasSubmetidasASuccaoExterna = (areas, anguloDoVento) =&gt; {
  <span class="s0">switch </span>(anguloDoVento) {
    <span class="s0">case </span><span class="s4">0</span>:
      <span class="s0">return </span>areas[<span class="s2">'a1'</span>] + areas[<span class="s2">'a2'</span>] + areas[<span class="s2">'a3'</span>] + areas[<span class="s2">'b1'</span>] + areas[<span class="s2">'b2'</span>] + areas[<span class="s2">'b3'</span>] + areas[<span class="s2">'d1'</span>] + areas[<span class="s2">'d2'</span>];
    <span class="s0">case </span><span class="s4">90</span>:
      <span class="s0">return </span>areas[<span class="s2">'c1'</span>] + areas[<span class="s2">'c2'</span>] + areas[<span class="s2">'b1'</span>] + areas[<span class="s2">'b2'</span>] + areas[<span class="s2">'b3'</span>] + areas[<span class="s2">'d1'</span>] + areas[<span class="s2">'d2'</span>];
    <span class="s0">case </span><span class="s4">180</span>:
      <span class="s0">return </span>areas[<span class="s2">'a1'</span>] + areas[<span class="s2">'a2'</span>] + areas[<span class="s2">'a3'</span>] + areas[<span class="s2">'b1'</span>] + areas[<span class="s2">'b2'</span>] + areas[<span class="s2">'b3'</span>] + areas[<span class="s2">'c1'</span>] + areas[<span class="s2">'c2'</span>];
    <span class="s0">case </span><span class="s4">270</span>:
      <span class="s0">return </span>areas[<span class="s2">'c1'</span>] + areas[<span class="s2">'c2'</span>] + areas[<span class="s2">'a1'</span>] + areas[<span class="s2">'a2'</span>] + areas[<span class="s2">'a3'</span>] + areas[<span class="s2">'d1'</span>] + areas[<span class="s2">'d2'</span>];
  }
};

<span class="s0">const </span>IndicePressaoInternaAberturaDominanteVentoAZero = (
  secao,
  aberturas,
  coefsPressaoExterna
) =&gt; {

  <span class="s0">switch</span>(secao) {
    <span class="s0">case </span><span class="s2">'c1'</span>:
      <span class="s0">return </span>coefPressaoInternaBarlavento(secao, aberturas, <span class="s4">0</span>);
    <span class="s0">case </span><span class="s2">'c2'</span>:
      <span class="s0">return </span>coefPressaoInternaBarlavento(secao,aberturas, <span class="s4">0</span>);
    <span class="s0">case </span><span class="s2">'a1'</span>:
      <span class="s0">return </span>coefPressaoInternaAltaSuccao(secao, aberturas, <span class="s4">0</span>);
    <span class="s0">case </span><span class="s2">'b1'</span>:
      <span class="s0">return </span>coefPressaoInternaAltaSuccao(secao, aberturas, <span class="s4">0</span>);
    <span class="s0">case </span><span class="s2">'a2'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'b2'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'a3'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'b3'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'d1'</span>:
      <span class="s0">return </span>coefPressaoInternaSotavento(<span class="s2">'d'</span>, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'d2'</span>:
      <span class="s0">return </span>coefPressaoInternaSotavento(<span class="s2">'d'</span>, coefsPressaoExterna);
    <span class="s0">default</span>:
      <span class="s0">throw new </span>Error(<span class="s2">'Seção de pressão externa inválida: ' </span>+ secao);
  }
};

<span class="s0">const </span>IndicePressaoInternaAberturaDominanteVentoANoventa = (
  secao,
  aberturas,
  coefsPressaoExterna
) =&gt; {

  <span class="s0">switch</span>(secao) {
    <span class="s0">case </span><span class="s2">'a1'</span>:
      <span class="s0">return </span>coefPressaoInternaBarlavento(secao, aberturas, <span class="s4">90</span>);
    <span class="s0">case </span><span class="s2">'a2'</span>:
      <span class="s0">return </span>coefPressaoInternaBarlavento(secao, aberturas, <span class="s4">90</span>);
    <span class="s0">case </span><span class="s2">'a3'</span>:
      <span class="s0">return </span>coefPressaoInternaBarlavento(secao, aberturas, <span class="s4">90</span>);
    <span class="s0">case </span><span class="s2">'c1'</span>:
      <span class="s0">return </span>coefPressaoInternaAltaSuccao(secao, aberturas, <span class="s4">90</span>);
    <span class="s0">case </span><span class="s2">'d1'</span>:
      <span class="s0">return </span>coefPressaoInternaAltaSuccao(secao, aberturas, <span class="s4">90</span>);
    <span class="s0">case </span><span class="s2">'c2'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'d2'</span>:
      <span class="s0">return </span>coefPressaoInternaBaixaSuccao(secao, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'b1'</span>:
      <span class="s0">return </span>coefPressaoInternaSotavento(<span class="s2">'b'</span>, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'b2'</span>:
      <span class="s0">return </span>coefPressaoInternaSotavento(<span class="s2">'b'</span>, coefsPressaoExterna);
    <span class="s0">case </span><span class="s2">'b3'</span>:
      <span class="s0">return </span>coefPressaoInternaSotavento(<span class="s2">'b'</span>, coefsPressaoExterna);
    <span class="s0">default</span>:
      <span class="s0">throw new </span>Error(<span class="s2">'Seção de pressão externa inválida: ' </span>+ secao);
  }
};

<span class="s0">const </span>coefPressaoInternaBarlavento = (secao, aberturas, angulo) =&gt; {
  <span class="s0">let </span>coeficientePressaoInterna,
      total,
      proporcao,
      aberturaDominante = <span class="s4">0</span>,
      face;

  face = secao.charAt(<span class="s4">0</span>);

  <span class="s0">for </span>(<span class="s0">let </span>s <span class="s0">in </span>aberturas) {
    <span class="s0">if </span>(s.charAt(<span class="s4">0</span>) === face) {
      aberturaDominante += aberturas[s]
    }
  }

  total = somarAreasSubmetidasASuccaoExterna(aberturas, angulo);
  proporcao = aberturaDominante / total;

  <span class="s0">if </span>(proporcao &gt;= <span class="s4">6</span>) <span class="s0">return </span><span class="s4">0.8</span>;

  coeficientePressaoInterna = PI_AD_BARLAVENTO.get(proporcao);

  <span class="s0">if </span>(!coeficientePressaoInterna) {
    <span class="s0">let </span>limites = Utils.pegarLimitesDeIntervalo(PI_AD_BARLAVENTO.keys(), proporcao);

    <span class="s0">return </span>Utils.interpolar(
      limites[<span class="s4">0</span>],
      PI_AD_BARLAVENTO.get(limites[<span class="s4">0</span>]),
      limites[<span class="s4">1</span>],
      PI_AD_BARLAVENTO.get(limites[<span class="s4">1</span>]),
      proporcao
    );
  }

  <span class="s0">return </span>coeficientePressaoInterna;
};

<span class="s0">const </span>coefPressaoInternaSotavento = (
  secao,
  coeficientes
) =&gt; {
  <span class="s0">return </span>coeficientes[secao];
};



<span class="s0">const </span>coefPressaoInternaAltaSuccao = (
  secao,
  aberturas,
  angulo
) =&gt; {
  <span class="s0">let </span>total,
      proporcao,
      coefPI;

  total = somarAreasSubmetidasASuccaoExterna(aberturas, angulo);
  proporcao = aberturas[secao] / (total - aberturas[secao]);

  <span class="s0">if </span>(proporcao &gt;= <span class="s4">3</span>) <span class="s0">return </span>-<span class="s4">0.9</span>;

  coefPI = PI_AD_ALTA_SUCCAO.get(proporcao);

  <span class="s0">if </span>(!coefPI) {
    <span class="s0">let </span>limites = Utils.pegarLimitesDeIntervalo(PI_AD_ALTA_SUCCAO.keys(), proporcao);

     coefPI = Utils.interpolar(
      limites[<span class="s4">0</span>],
      PI_AD_ALTA_SUCCAO.get(limites[<span class="s4">0</span>]),
      limites[<span class="s4">1</span>],
      PI_AD_ALTA_SUCCAO.get(limites[<span class="s4">1</span>]),
      proporcao
    );

    <span class="s0">return </span>coefPI;
  }

  <span class="s0">return </span>coefPI;
};

<span class="s0">const </span>coefPressaoInternaBaixaSuccao = (
  secao,
  coeficientes
) =&gt; {
  <span class="s0">return </span>coeficientes[secao];
};

<span class="s0">const </span>externaTelhado = ({
 inclinacaoTelhado,
 altura,
 largura
}) =&gt; {
  <span class="s0">let </span>indiceAlturaRelativa,
      indiceAngulo,
      mapa;

  inclinacaoTelhado = parseInt(inclinacaoTelhado);

  indiceAlturaRelativa = pegarIndiceAlturaRelativaTelhado(altura, largura);
  mapa = qualMapa(indiceAlturaRelativa);
  indiceAngulo = mapa.get(inclinacaoTelhado);

  <span class="s0">if </span>(!indiceAngulo) {
    <span class="s0">let </span>angulosMaisProximos = acharAngulosTabeladosMaisProximos(inclinacaoTelhado, mapa);

    <span class="s0">return </span>pegarValorTabela5({
      indiceAlturaRelativa,
      indiceAnguloUm: angulosMaisProximos[<span class="s4">0</span>][<span class="s4">1</span>],
      anguloUm: angulosMaisProximos[<span class="s4">0</span>][<span class="s4">0</span>],
      indiceAnguloDois: angulosMaisProximos[<span class="s4">1</span>][<span class="s4">1</span>],
      anguloDois: angulosMaisProximos[<span class="s4">1</span>][<span class="s4">0</span>],
      angulo: inclinacaoTelhado
    });
  } <span class="s0">else </span>{
    <span class="s0">return </span>pegarValorTabela5({
      indiceAlturaRelativa,
      indiceAnguloUm: indiceAngulo
    });
  }
};

<span class="s0">const </span>pegarIndiceAlturaRelativaTelhado = (altura, largura) =&gt; {
  <span class="s0">if </span>(altura/largura &lt;= <span class="s4">0.5</span>) <span class="s0">return </span><span class="s4">0</span>;
  <span class="s0">else if </span>(altura/largura &gt; <span class="s4">0.5 </span>&amp;&amp; altura/largura &lt;= <span class="s4">3</span>/<span class="s4">2</span>) <span class="s0">return </span><span class="s4">1</span>;
  <span class="s0">else if </span>(altura/largura &gt; <span class="s4">3</span>/<span class="s4">2 </span>&amp;&amp; altura/largura &lt;= <span class="s4">6</span>) <span class="s0">return </span><span class="s4">2</span>;
  <span class="s0">else </span>{
    <span class="s0">throw new </span>Error(<span class="s2">'Altura fora da faixa aceitável: ' </span>+ altura);
  }
};

<span class="s0">const </span>pegarValorTabela5 = ({
  indiceAlturaRelativa,
  indiceAnguloUm,
  anguloUm,
  indiceAnguloDois,
  anguloDois,
  angulo = <span class="s0">false</span>
}) =&gt; {
  <span class="s0">if </span>(angulo) {
    <span class="s0">let </span>coeficienteUm = TABELA_5[indiceAlturaRelativa][indiceAnguloUm],
        coeficienteDois = TABELA_5[indiceAlturaRelativa][indiceAnguloDois];

    <span class="s0">return </span>{
      ventoAZero: Utils.interpolarObjetos(anguloUm, coeficienteUm.ventoAZero, anguloDois, coeficienteDois.ventoAZero, angulo),
      ventoANoventa: Utils.interpolarObjetos(anguloUm, coeficienteUm.ventoANoventa, anguloDois, coeficienteDois.ventoANoventa, angulo)
    };
  } <span class="s0">else </span>{
    <span class="s0">return </span>TABELA_5[indiceAlturaRelativa][indiceAnguloUm];
  }
};

<span class="s0">const </span>qualMapa = (indiceAlturaRelativa) =&gt; {
  <span class="s0">if </span>(indiceAlturaRelativa === <span class="s4">0 </span>|| indiceAlturaRelativa === <span class="s4">1</span>) {
    <span class="s0">return </span>MAPA_ANG_AR_FAIXAS_UM_DOIS;
  } <span class="s0">else if </span>(indiceAlturaRelativa === <span class="s4">2</span>) {
    <span class="s0">return </span>MAPA_ANG_AR_FAIXA_TRES;
  }
};



<span class="s0">const </span>acharAngulosTabeladosMaisProximos = (angulo, mapa) =&gt; {
  <span class="s0">let </span>anterior = <span class="s4">0</span>;

  <span class="s0">for </span>(<span class="s0">var </span>anguloTestado of mapa.keys()) {
    <span class="s0">if </span>(angulo &lt; anguloTestado &amp;&amp; angulo &gt; anterior) {
      <span class="s0">return </span>[[anterior, mapa.get(anterior)], [anguloTestado, mapa.get(anguloTestado)]];
    }

    anterior = anguloTestado;
  }
};

module.exports = {
  externaParedesPlantaRetangular,
  externaTelhado,
  interna
};</pre>
</body>
</html>